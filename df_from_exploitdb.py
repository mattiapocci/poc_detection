import subprocess
import pandas as pd

ls = "ls /opt/exploit-database/exploits/"
ls = subprocess.getstatusoutput(ls)
ls_exploits = ls[1].split('\n')

exploit_df = pd.DataFrame(columns=['id','exploit'])
for folder in ls_exploits:
    #print(folder.lower())
    #print('---')
    if 'windows' in folder.lower():
        ls = "ls /opt/exploit-database/exploits/" + folder
        ls = subprocess.getstatusoutput(ls)
        winfolders = ls[1].split('\n')
        #print(winfolders)
        for wf in winfolders:
            ls = "ls /opt/exploit-database/exploits/" + folder + '/' + wf
            ls = subprocess.getstatusoutput(ls)
            subfolders = ls[1].split('\n')
            #print(subfolders)
            for s in subfolders:
                print(s)
                with open('/opt/exploit-database/exploits/' + folder + '/' + wf + '/' + s,'r') as f:
                    content = f.read()
                exploit_df = exploit_df.append({'id' : s , 'exploit' : content} , ignore_index=True)
                print('Added exploit with id: ' + s)
        

print(exploit_df)
exploit_df.to_csv(r'wincve_exploitdb_exploits.csv', index = False)

ls = "ls /opt/exploit-database/shellcodes/"
ls = subprocess.getstatusoutput(ls)
ls_shellcodes = ls[1].split('\n')
shellcodes_df = pd.DataFrame(columns=['id','shellcode'])
for folder in ls_shellcodes:
    #print(folder.lower())
    #print('---')
    if 'windows' in folder.lower():
        ls = "ls /opt/exploit-database/shellcodes/" + folder
        ls = subprocess.getstatusoutput(ls)
        winfolders = ls[1].split('\n')
        print(winfolders)
        #print(winfolders)
        for s in winfolders:
            print(s)
            with open('/opt/exploit-database/shellcodes/' + folder + '/' + s,'r') as f:
                content = f.read()
            shellcodes_df = shellcodes_df.append({'id' : s , 'shellcode' : content} , ignore_index=True)
            print('Added shellcode with id: ' + s)
print(shellcodes_df)
shellcodes_df.to_csv(r'wincve_exploitdb_shellcodes.csv', index = False)